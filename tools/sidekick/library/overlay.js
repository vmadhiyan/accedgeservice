import{i as Kt,e as G,S as qt,f as jt,r as Vt,x as wt,l as it}from"./index.js";var Ut=Kt`
@keyframes sp-overlay-fade-in{0%{opacity:0;transform:var(--sp-overlay-from)}to{opacity:1;transform:translate(0)}}@keyframes sp-overlay-fade-out{0%{opacity:1;transform:translate(0)}to{opacity:0;transform:var(--sp-overlay-from)}}:host{display:inline-block;left:-9999em;max-height:100%;pointer-events:none;position:fixed;top:-9999em;z-index:1000}:host(:focus){outline:none}:host([placement=none]){height:100vh;height:100dvh;height:-webkit-fill-available;height:fill-available;left:0;position:fixed;top:0}#contents,sp-theme{height:100%}#contents{--swc-overlay-animation-distance:var(
--spectrum-picker-m-texticon-popover-offset-y,var(--spectrum-global-dimension-size-75)
);animation-duration:var(
--swc-test-duration,var(--spectrum-global-animation-duration-200,.16s)
);animation-timing-function:var(
--spectrum-global-animation-ease-out,ease-out
);box-sizing:border-box;display:inline-block;opacity:1;pointer-events:none;visibility:visible}:host([actual-placement*=top]) #contents{--sp-overlay-from:translateY(var(--spectrum-global-dimension-size-75));align-items:flex-end;display:inline-flex;padding-top:var(--swc-overlay-animation-distance)}:host([actual-placement*=right]) #contents{--sp-overlay-from:translateX(calc(var(--spectrum-global-dimension-size-75)*-1));padding-right:var(--swc-overlay-animation-distance)}:host([actual-placement*=bottom]) #contents{--sp-overlay-from:translateY(calc(var(--spectrum-global-dimension-size-75)*-1));padding-bottom:var(--swc-overlay-animation-distance)}:host([actual-placement*=left]) #contents{--sp-overlay-from:translateX(var(--spectrum-global-dimension-size-75));padding-left:var(--swc-overlay-animation-distance)}:host([animating]) ::slotted(*){pointer-events:none}:host(:not([animating])) ::slotted(*){pointer-events:auto}#contents ::slotted(*){position:relative}
`;const V=t=>{if(!t)return null;const e=t.closest("active-overlay");if(e)return e;const i=t.getRootNode();return i.host?V(i.host):null},ht=(t,e)=>{const i=[];if(!t)return[];for(const n of e)n.root&&V(n.root)===t&&(i.push(n),i.push(...ht(n,e)));return i};function U(t){return t.split("-")[1]}function dt(t){return t==="y"?"height":"width"}function N(t){return t.split("-")[0]}function X(t){return["top","bottom"].includes(N(t))?"x":"y"}function xt(t,e,i){let{reference:n,floating:s}=t;const o=n.x+n.width/2-s.width/2,r=n.y+n.height/2-s.height/2,l=X(e),a=dt(l),c=n[a]/2-s[a]/2,h=l==="x";let d;switch(N(e)){case"top":d={x:o,y:n.y-s.height};break;case"bottom":d={x:o,y:n.y+n.height};break;case"right":d={x:n.x+n.width,y:r};break;case"left":d={x:n.x-s.width,y:r};break;default:d={x:n.x,y:n.y}}switch(U(e)){case"start":d[l]-=c*(i&&h?-1:1);break;case"end":d[l]+=c*(i&&h?-1:1)}return d}function Ct(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function nt(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function pt(t,e){var i;e===void 0&&(e={});const{x:n,y:s,platform:o,rects:r,elements:l,strategy:a}=t,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:d="floating",altBoundary:p=!1,padding:u=0}=e,m=Ct(u),f=l[p?d==="floating"?"reference":"floating":d],b=nt(await o.getClippingRect({element:(i=await(o.isElement==null?void 0:o.isElement(f)))==null||i?f:f.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:c,rootBoundary:h,strategy:a})),g=d==="floating"?{...r.floating,x:n,y:s}:r.reference,v=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),y=await(o.isElement==null?void 0:o.isElement(v))&&await(o.getScale==null?void 0:o.getScale(v))||{x:1,y:1},w=nt(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:g,offsetParent:v,strategy:a}):g);return{top:(b.top-w.top+m.top)/y.y,bottom:(w.bottom-b.bottom+m.bottom)/y.y,left:(b.left-w.left+m.left)/y.x,right:(w.right-b.right+m.right)/y.x}}const mt=Math.min,K=Math.max;function ut(t,e,i){return K(t,mt(e,i))}const Xt={left:"right",right:"left",bottom:"top",top:"bottom"};function ot(t){return t.replace(/left|right|bottom|top/g,e=>Xt[e])}const Yt={start:"end",end:"start"};function ft(t){return t.replace(/start|end/g,e=>Yt[e])}const Tt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var i;const{placement:n,middlewareData:s,rects:o,initialPlacement:r,platform:l,elements:a}=e,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:m=!0,...f}=t,b=N(n),g=N(r)===r,v=await(l.isRTL==null?void 0:l.isRTL(a.floating)),y=d||(g||!m?[ot(r)]:function(T){const M=ot(T);return[ft(T),M,ft(M)]}(r));d||u==="none"||y.push(...function(T,M,P,A){const R=U(T);let E=function(W,k,z){const et=["left","right"],bt=["right","left"],It=["top","bottom"],$t=["bottom","top"];switch(W){case"top":case"bottom":return z?k?bt:et:k?et:bt;case"left":case"right":return k?It:$t;default:return[]}}(N(T),P==="start",A);return R&&(E=E.map(W=>W+"-"+R),M&&(E=E.concat(E.map(ft)))),E}(r,m,u,v));const w=[r,...y],x=await pt(e,f),C=[];let O=((i=s.flip)==null?void 0:i.overflows)||[];if(c&&C.push(x[b]),h){const{main:T,cross:M}=function(P,A,R){R===void 0&&(R=!1);const E=U(P),W=X(P),k=dt(W);let z=W==="x"?E===(R?"end":"start")?"right":"left":E==="start"?"bottom":"top";return A.reference[k]>A.floating[k]&&(z=ot(z)),{main:z,cross:ot(z)}}(n,o,v);C.push(x[T],x[M])}if(O=[...O,{placement:n,overflows:C}],!C.every(T=>T<=0)){var L,F;const T=(((L=s.flip)==null?void 0:L.index)||0)+1,M=w[T];if(M)return{data:{index:T,overflows:O},reset:{placement:M}};let P=(F=O.filter(A=>A.overflows[0]<=0).sort((A,R)=>A.overflows[1]-R.overflows[1])[0])==null?void 0:F.placement;if(!P)switch(p){case"bestFit":{var $;const A=($=O.map(R=>[R.placement,R.overflows.filter(E=>E>0).reduce((E,W)=>E+W,0)]).sort((R,E)=>R[1]-E[1])[0])==null?void 0:$[0];A&&(P=A);break}case"initialPlacement":P=r}if(n!==P)return{reset:{placement:P}}}return{}}}},Gt=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:i,y:n}=e,s=await async function(o,r){const{placement:l,platform:a,elements:c}=o,h=await(a.isRTL==null?void 0:a.isRTL(c.floating)),d=N(l),p=U(l),u=X(l)==="x",m=["left","top"].includes(d)?-1:1,f=h&&u?-1:1,b=typeof r=="function"?r(o):r;let{mainAxis:g,crossAxis:v,alignmentAxis:y}=typeof b=="number"?{mainAxis:b,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...b};return p&&typeof y=="number"&&(v=p==="end"?-1*y:y),u?{x:v*f,y:g*m}:{x:g*m,y:v*f}}(e,t);return{x:i+s.x,y:n+s.y,data:s}}}},Jt=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:i,rects:n,platform:s,elements:o}=e,{apply:r=()=>{},...l}=t,a=await pt(e,l),c=N(i),h=U(i),d=X(i)==="x",{width:p,height:u}=n.floating;let m,f;c==="top"||c==="bottom"?(m=c,f=h===(await(s.isRTL==null?void 0:s.isRTL(o.floating))?"start":"end")?"left":"right"):(f=c,m=h==="end"?"top":"bottom");const b=u-a[m],g=p-a[f],v=!e.middlewareData.shift;let y=b,w=g;if(d){const C=p-a.left-a.right;w=h||v?mt(g,C):C}else{const C=u-a.top-a.bottom;y=h||v?mt(b,C):C}if(v&&!h){const C=K(a.left,0),O=K(a.right,0),L=K(a.top,0),F=K(a.bottom,0);d?w=p-2*(C!==0||O!==0?C+O:K(a.left,a.right)):y=u-2*(L!==0||F!==0?L+F:K(a.top,a.bottom))}await r({...e,availableWidth:w,availableHeight:y});const x=await s.getDimensions(o.floating);return p!==x.width||u!==x.height?{reset:{rects:!0}}:{}}}};function D(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function _(t){return D(t).getComputedStyle(t)}function Ot(t){return t instanceof D(t).Node}function B(t){return Ot(t)?(t.nodeName||"").toLowerCase():""}let st;function Et(){if(st)return st;const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?(st=t.brands.map(e=>e.brand+"/"+e.version).join(" "),st):navigator.userAgent}function S(t){return t instanceof D(t).HTMLElement}function H(t){return t instanceof D(t).Element}function At(t){return typeof ShadowRoot>"u"?!1:t instanceof D(t).ShadowRoot||t instanceof ShadowRoot}function rt(t){const{overflow:e,overflowX:i,overflowY:n,display:s}=_(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+i)&&!["inline","contents"].includes(s)}function Qt(t){return["table","td","th"].includes(B(t))}function vt(t){const e=/firefox/i.test(Et()),i=_(t),n=i.backdropFilter||i.WebkitBackdropFilter;return i.transform!=="none"||i.perspective!=="none"||!!n&&n!=="none"||e&&i.willChange==="filter"||e&&!!i.filter&&i.filter!=="none"||["transform","perspective"].some(s=>i.willChange.includes(s))||["paint","layout","strict","content"].some(s=>{const o=i.contain;return o!=null&&o.includes(s)})}function yt(){return/^((?!chrome|android).)*safari/i.test(Et())}function gt(t){return["html","body","#document"].includes(B(t))}const Rt=Math.min,J=Math.max,at=Math.round;function Pt(t){const e=_(t);let i=parseFloat(e.width),n=parseFloat(e.height);const s=S(t),o=s?t.offsetWidth:i,r=s?t.offsetHeight:n,l=at(i)!==o||at(n)!==r;return l&&(i=o,n=r),{width:i,height:n,fallback:l}}function kt(t){return H(t)?t:t.contextElement}const Lt={x:1,y:1};function Y(t){const e=kt(t);if(!S(e))return Lt;const i=e.getBoundingClientRect(),{width:n,height:s,fallback:o}=Pt(e);let r=(o?at(i.width):i.width)/n,l=(o?at(i.height):i.height)/s;return r&&Number.isFinite(r)||(r=1),l&&Number.isFinite(l)||(l=1),{x:r,y:l}}function q(t,e,i,n){var s,o;e===void 0&&(e=!1),i===void 0&&(i=!1);const r=t.getBoundingClientRect(),l=kt(t);let a=Lt;e&&(n?H(n)&&(a=Y(n)):a=Y(t));const c=l?D(l):window,h=yt()&&i;let d=(r.left+(h&&((s=c.visualViewport)==null?void 0:s.offsetLeft)||0))/a.x,p=(r.top+(h&&((o=c.visualViewport)==null?void 0:o.offsetTop)||0))/a.y,u=r.width/a.x,m=r.height/a.y;if(l){const f=D(l),b=n&&H(n)?D(n):n;let g=f.frameElement;for(;g&&n&&b!==f;){const v=Y(g),y=g.getBoundingClientRect(),w=getComputedStyle(g);y.x+=(g.clientLeft+parseFloat(w.paddingLeft))*v.x,y.y+=(g.clientTop+parseFloat(w.paddingTop))*v.y,d*=v.x,p*=v.y,u*=v.x,m*=v.y,d+=y.x,p+=y.y,g=D(g).frameElement}}return nt({width:u,height:m,x:d,y:p})}function I(t){return((Ot(t)?t.ownerDocument:t.document)||window.document).documentElement}function lt(t){return H(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Ft(t){return q(I(t)).left+lt(t).scrollLeft}function Q(t){if(B(t)==="html")return t;const e=t.assignedSlot||t.parentNode||At(t)&&t.host||I(t);return At(e)?e.host:e}function Dt(t){const e=Q(t);return gt(e)?e.ownerDocument.body:S(e)&&rt(e)?e:Dt(e)}function Z(t,e){var i;e===void 0&&(e=[]);const n=Dt(t),s=n===((i=t.ownerDocument)==null?void 0:i.body),o=D(n);return s?e.concat(o,o.visualViewport||[],rt(n)?n:[]):e.concat(n,Z(n))}function Mt(t,e,i){let n;if(e==="viewport")n=function(r,l){const a=D(r),c=I(r),h=a.visualViewport;let d=c.clientWidth,p=c.clientHeight,u=0,m=0;if(h){d=h.width,p=h.height;const f=yt();(!f||f&&l==="fixed")&&(u=h.offsetLeft,m=h.offsetTop)}return{width:d,height:p,x:u,y:m}}(t,i);else if(e==="document")n=function(r){const l=I(r),a=lt(r),c=r.ownerDocument.body,h=J(l.scrollWidth,l.clientWidth,c.scrollWidth,c.clientWidth),d=J(l.scrollHeight,l.clientHeight,c.scrollHeight,c.clientHeight);let p=-a.scrollLeft+Ft(r);const u=-a.scrollTop;return _(c).direction==="rtl"&&(p+=J(l.clientWidth,c.clientWidth)-h),{width:h,height:d,x:p,y:u}}(I(t));else if(H(e))n=function(r,l){const a=q(r,!0,l==="fixed"),c=a.top+r.clientTop,h=a.left+r.clientLeft,d=S(r)?Y(r):{x:1,y:1};return{width:r.clientWidth*d.x,height:r.clientHeight*d.y,x:h*d.x,y:c*d.y}}(e,i);else{const r={...e};if(yt()){var s,o;const l=D(t);r.x-=((s=l.visualViewport)==null?void 0:s.offsetLeft)||0,r.y-=((o=l.visualViewport)==null?void 0:o.offsetTop)||0}n=r}return nt(n)}function Wt(t,e){return S(t)&&_(t).position!=="fixed"?e?e(t):t.offsetParent:null}function St(t,e){const i=D(t);if(!S(t))return i;let n=Wt(t,e);for(;n&&Qt(n)&&_(n).position==="static";)n=Wt(n,e);return n&&(B(n)==="html"||B(n)==="body"&&_(n).position==="static"&&!vt(n))?i:n||function(s){let o=Q(s);for(;S(o)&&!gt(o);){if(vt(o))return o;o=Q(o)}return null}(t)||i}function Zt(t,e,i){const n=S(e),s=I(e),o=q(t,!0,i==="fixed",e);let r={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if(n||!n&&i!=="fixed")if((B(e)!=="body"||rt(s))&&(r=lt(e)),S(e)){const a=q(e,!0);l.x=a.x+e.clientLeft,l.y=a.y+e.clientTop}else s&&(l.x=Ft(s));return{x:o.left+r.scrollLeft-l.x,y:o.top+r.scrollTop-l.y,width:o.width,height:o.height}}const te={getClippingRect:function(t){let{element:e,boundary:i,rootBoundary:n,strategy:s}=t;const o=[...i==="clippingAncestors"?function(a,c){const h=c.get(a);if(h)return h;let d=Z(a).filter(f=>H(f)&&B(f)!=="body"),p=null;const u=_(a).position==="fixed";let m=u?Q(a):a;for(;H(m)&&!gt(m);){const f=_(m),b=vt(m);f.position==="fixed"&&(p=null),(u?b||p:b||f.position!=="static"||!p||!["absolute","fixed"].includes(p.position))?p=f:d=d.filter(g=>g!==m),m=Q(m)}return c.set(a,d),d}(e,this._c):[].concat(i),n],r=o[0],l=o.reduce((a,c)=>{const h=Mt(e,c,s);return a.top=J(h.top,a.top),a.right=Rt(h.right,a.right),a.bottom=Rt(h.bottom,a.bottom),a.left=J(h.left,a.left),a},Mt(e,r,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:i,strategy:n}=t;const s=S(i),o=I(i);if(i===o)return e;let r={scrollLeft:0,scrollTop:0},l={x:1,y:1};const a={x:0,y:0};if((s||!s&&n!=="fixed")&&((B(i)!=="body"||rt(o))&&(r=lt(i)),S(i))){const c=q(i);l=Y(i),a.x=c.x+i.clientLeft,a.y=c.y+i.clientTop}return{width:e.width*l.x,height:e.height*l.y,x:e.x*l.x-r.scrollLeft*l.x+a.x,y:e.y*l.y-r.scrollTop*l.y+a.y}},isElement:H,getDimensions:function(t){return Pt(t)},getOffsetParent:St,getDocumentElement:I,getScale:Y,async getElementRects(t){let{reference:e,floating:i,strategy:n}=t;const s=this.getOffsetParent||St,o=this.getDimensions;return{reference:Zt(e,await s(i),n),floating:{x:0,y:0,...await o(i)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>_(t).direction==="rtl"},ee=(t,e,i)=>{const n=new Map,s={platform:te,...i},o={...s.platform,_c:n};return(async(r,l,a)=>{const{placement:c="bottom",strategy:h="absolute",middleware:d=[],platform:p}=a,u=d.filter(Boolean),m=await(p.isRTL==null?void 0:p.isRTL(l));let f=await p.getElementRects({reference:r,floating:l,strategy:h}),{x:b,y:g}=xt(f,c,m),v=c,y={},w=0;for(let x=0;x<u.length;x++){const{name:C,fn:O}=u[x],{x:L,y:F,data:$,reset:T}=await O({x:b,y:g,initialPlacement:c,placement:v,strategy:h,middlewareData:y,rects:f,platform:p,elements:{reference:r,floating:l}});b=L!=null?L:b,g=F!=null?F:g,y={...y,[C]:{...y[C],...$}},T&&w<=50&&(w++,typeof T=="object"&&(T.placement&&(v=T.placement),T.rects&&(f=T.rects===!0?await p.getElementRects({reference:r,floating:l,strategy:h}):T.rects),{x:b,y:g}=xt(f,v,m)),x=-1)}return{x:b,y:g,placement:v,strategy:h,middlewareData:y}})(t,e,{...s,platform:o})};var ie=Object.defineProperty,ne=Object.getOwnPropertyDescriptor,tt=(t,e,i,n)=>{for(var s,o=n>1?void 0:n?ne(e,i):e,r=t.length-1;r>=0;r--)(s=t[r])&&(o=(n?s(e,i,o):s(o))||o);return n&&o&&ie(e,i,o),o};const Ht={initial:"idle",states:{idle:{on:{active:"active"}},active:{on:{hiding:"hiding",idle:"idle"}},hiding:{on:{dispose:"dispose"}},dispose:{on:{disposed:"disposed"}},disposed:{on:{}}}},zt=(t,e)=>t?e&&Ht.states[t].on[e]||t:Ht.initial,oe=t=>{var e;return(e={left:["right","bottom","top"],"left-start":["right-start","bottom","top"],"left-end":["right-end","bottom","top"],right:["left","bottom","top"],"right-start":["left-start","bottom","top"],"right-end":["left-end","bottom","top"],top:["bottom","left","right"],"top-start":["bottom-start","left","right"],"top-end":["bottom-end","left","right"],bottom:["top","left","right"],"bottom-start":["top-start","left","right"],"bottom-end":["top-end","left","right"]}[t])!=null?e:[t]},_t=class extends qt{constructor(){super(),this.contentAnimationPromise=Promise.resolve(!0),this.resolveContentAnimationPromise=()=>{},this._state=zt(),this.animating=!1,this.theme={},this.tabbingAway=!1,this.offset=6,this.skidding=0,this.interaction="hover",this.positionAnimationFrame=0,this.willNotifyClosed=!1,this.isConstrained=!1,this.updateOverlayPosition=()=>{this.interaction!=="modal"&&this.cleanup?this.dispatchEvent(new Event("close")):this.setOverlayPosition()},this.resetOverlayPosition=()=>{this.style.removeProperty("max-height"),this.style.removeProperty("height"),this.initialHeight=void 0,this.isConstrained=!1,this.offsetHeight,this.setOverlayPosition()},this.setOverlayPosition=async()=>{if(!this.placement||this.placement==="none")return;function t(a){const c=window.devicePixelRatio||1;return Math.round(a*c)/c||-1e4}await(document.fonts?document.fonts.ready:Promise.resolve());const e=this.virtualTrigger?Tt({padding:8,fallbackPlacements:oe(this.placement)}):Tt({padding:8}),i=[Gt({mainAxis:this.offset,crossAxis:this.skidding}),(n={padding:8},n===void 0&&(n={}),{name:"shift",options:n,async fn(a){const{x:c,y:h,placement:d}=a,{mainAxis:p=!0,crossAxis:u=!1,limiter:m={fn:O=>{let{x:L,y:F}=O;return{x:L,y:F}}},...f}=n,b={x:c,y:h},g=await pt(a,f),v=X(N(d)),y=v==="x"?"y":"x";let w=b[v],x=b[y];if(p){const O=v==="y"?"bottom":"right";w=ut(w+g[v==="y"?"top":"left"],w,w-g[O])}if(u){const O=y==="y"?"bottom":"right";x=ut(x+g[y==="y"?"top":"left"],x,x-g[O])}const C=m.fn({...a,[v]:w,[y]:x});return{...C,data:{x:C.x-c,y:C.y-h}}}}),e,Jt({padding:8,apply:({availableWidth:a,availableHeight:c,rects:{floating:h}})=>{const d=Math.max(100,Math.floor(c)),p=h.height;this.initialHeight=(this.isConstrained||this.virtualTrigger)&&this.initialHeight||p,this.isConstrained=p<this.initialHeight||d<=p;const u=this.isConstrained?`${d}px`:"";Object.assign(this.style,{maxWidth:`${Math.floor(a)}px`,maxHeight:u,height:u})}})];var n;this.overlayContentTip&&i.push((a=>({name:"arrow",options:a,async fn(c){const{element:h,padding:d=0}=a||{},{x:p,y:u,placement:m,rects:f,platform:b,elements:g}=c;if(h==null)return{};const v=Ct(d),y={x:p,y:u},w=X(m),x=dt(w),C=await b.getDimensions(h),O=w==="y",L=O?"top":"left",F=O?"bottom":"right",$=O?"clientHeight":"clientWidth",T=f.reference[x]+f.reference[w]-y[w]-f.floating[x],M=y[w]-f.reference[w],P=await(b.getOffsetParent==null?void 0:b.getOffsetParent(h));let A=P?P[$]:0;A&&await(b.isElement==null?void 0:b.isElement(P))||(A=g.floating[$]||f.floating[x]);const R=T/2-M/2,E=v[L],W=A-C[x]-v[F],k=A/2-C[x]/2+R,z=ut(E,k,W),et=U(m)!=null&&k!=z&&f.reference[x]/2-(k<E?v[L]:v[F])-C[x]/2<0;return{[w]:y[w]-(et?k<E?E-k:W-k:0),data:{[w]:z,centerOffset:k-z}}}}))({element:this.overlayContentTip}));const{x:s,y:o,placement:r,middlewareData:l}=await ee(this.virtualTrigger||this.trigger,this,{placement:this.placement,middleware:i,strategy:"fixed"});if(Object.assign(this.style,{top:"0px",left:"0px",transform:`translate(${t(s)}px, ${t(o)}px)`}),r!==this.getAttribute("actual-placement")&&(this.setAttribute("actual-placement",r),this.overlayContent.setAttribute("placement",r)),this.overlayContentTip&&l.arrow){const{x:a,y:c}=l.arrow;Object.assign(this.overlayContentTip.style,{left:a!=null?`${t(a)}px`:"",top:c!=null?`${t(c)}px`:"",right:"",bottom:""})}},this.handleInlineTriggerKeydown=t=>{const{code:e,shiftKey:i}=t;if(e==="Tab"){if(i)return this.tabbingAway=!0,void this.dispatchEvent(new Event("close"));t.stopPropagation(),t.preventDefault(),this.focus()}},this.stealOverlayContentPromise=Promise.resolve(),this.stealOverlayContentPromise=new Promise(t=>this.stealOverlayContentResolver=t)}get state(){return this._state}set state(t){const e=zt(this.state,t);e!==this.state&&(this._state=e,this.state==="active"||this.state==="hiding"?this.setAttribute("state",this.state):this.removeAttribute("state"))}async focus(){const t=jt(this);if(t){t.updateComplete&&await t.updateComplete;const e=this.getRootNode().activeElement;(e===this||!this.contains(e))&&t.focus()}else super.focus();this.removeAttribute("tabindex")}get hasTheme(){return!!this.theme.color||!!this.theme.scale||!!this.theme.lang}static get styles(){return[Ut]}get hasModalRoot(){return!!this._modalRoot}feature(){this.contains(document.activeElement)||(this.tabIndex=-1);const t=V(this.trigger);t&&t.slot==="open"&&(this._modalRoot=t._modalRoot||t),(this.interaction==="modal"||this._modalRoot)&&(this.slot="open",this.interaction==="modal"&&this.setAttribute("aria-modal","true"),this._modalRoot&&(t==null||t.feature()))}obscure(t){if(this.slot&&t==="modal"){if(this.removeAttribute("slot"),this.removeAttribute("aria-modal"),this.interaction!=="modal"){const e=V(this.trigger);return this._modalRoot=e==null?void 0:e.obscure(t),this._modalRoot}return this}}async willUpdate(){this.hasUpdated||!this.overlayContent||!this.trigger||(this.stealOverlayContent(this.overlayContent),this.state="active",this.feature(),this.placement&&this.placement!=="none"&&(await this.updateOverlayPosition(),document.addEventListener("sp-update-overlays",this.resetOverlayPosition)),this.placement&&this.placement!=="none"&&(this.contentAnimationPromise=this.applyContentAnimation("sp-overlay-fade-in")))}async openCallback(t){await this.updateComplete,this.receivesFocus&&await this.focus(),await t(),this.trigger.dispatchEvent(new CustomEvent("sp-opened",{bubbles:!0,composed:!0,cancelable:!0,detail:{interaction:this.interaction}}))}open(t){this.extractDetail(t)}extractDetail(t){this.overlayContent=t.content,this.overlayContentTip=t.contentTip,this.trigger=t.trigger,this.virtualTrigger=t.virtualTrigger,this.placement=t.placement,this.offset=t.offset,this.skidding=t.skidding||0,this.interaction=t.interaction,this.theme=t.theme,this.receivesFocus=t.receivesFocus,this.root=t.root}dispose(){this.state==="dispose"&&(this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.trigger.removeEventListener("keydown",this.handleInlineTriggerKeydown),this.returnOverlayContent(),this.state="disposed",this.willNotifyClosed&&(this.overlayContent.dispatchEvent(new Event("sp-overlay-closed")),this.willNotifyClosed=!1),this.cleanup&&this.cleanup())}stealOverlayContent(t){this.originalPlacement=t.getAttribute("placement"),this.restoreContent=Vt([t],this,{position:"beforeend",prepareCallback:e=>{const i=e.slot,n=e.placement;return e.removeAttribute("slot"),s=>{s.slot=i,s.placement=n}}}),this.stealOverlayContentResolver()}returnOverlayContent(){if(!this.restoreContent)return;const[t]=this.restoreContent();this.restoreContent=void 0,this.willNotifyClosed=!0,this.originalPlacement&&(t.setAttribute("placement",this.originalPlacement),delete this.originalPlacement)}async placeOverlay(){!this.placement||this.placement==="none"||(this.cleanup=function(t,e,i,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:r=!0,animationFrame:l=!1}=n,a=s&&!l,c=a||o?[...H(t)?Z(t):t.contextElement?Z(t.contextElement):[],...Z(e)]:[];c.forEach(u=>{a&&u.addEventListener("scroll",i,{passive:!0}),o&&u.addEventListener("resize",i)});let h,d=null;r&&(d=new ResizeObserver(()=>{i()}),H(t)&&!l&&d.observe(t),H(t)||!t.contextElement||l||d.observe(t.contextElement),d.observe(e));let p=l?q(t):null;return l&&function u(){const m=q(t);!p||m.x===p.x&&m.y===p.y&&m.width===p.width&&m.height===p.height||i(),p=m,h=requestAnimationFrame(u)}(),i(),()=>{var u;c.forEach(m=>{a&&m.removeEventListener("scroll",i),o&&m.removeEventListener("resize",i)}),(u=d)==null||u.disconnect(),d=null,l&&cancelAnimationFrame(h)}}(this.virtualTrigger||this.trigger,this,this.updateOverlayPosition,{elementResize:!1}))}async hide(t=!0){this.state==="active"&&(this.state="hiding",t&&await this.applyContentAnimation("sp-overlay-fade-out"),this.state="dispose")}schedulePositionUpdate(){cancelAnimationFrame(this.positionAnimationFrame),this.positionAnimationFrame=requestAnimationFrame(()=>{this.cleanup?this.updateOverlayPosition():this.placeOverlay()})}onSlotChange(){this.schedulePositionUpdate()}applyContentAnimation(t){return this.placement==="none"?Promise.resolve(!0):(this.resolveContentAnimationPromise(),new Promise(e=>{this.resolveContentAnimationPromise=()=>{e(!1)};const i=this.shadowRoot.querySelector("#contents"),n=s=>{t===s.animationName&&(i.removeEventListener("animationend",n),i.removeEventListener("animationcancel",n),this.animating=!1,e(s.type==="animationcancel"))};i.addEventListener("animationend",n),i.addEventListener("animationcancel",n),i.style.animationName=t,this.animating=!0}))}renderTheme(t){const{color:e,scale:i,lang:n,theme:s}=this.theme;return wt`
            <sp-theme
                theme=${it(s)}
                color=${it(e)}
                scale=${it(i)}
                lang=${it(n)}
                part="theme"
            >
                ${t}
            </sp-theme>
        `}render(){const t=wt`
            <div id="contents">
                <slot @slotchange=${this.onSlotChange}></slot>
            </div>
        `;return this.hasTheme?this.renderTheme(t):t}static create(t){const e=new _t;return t.content&&e.open(t),e}async getUpdateComplete(){const t=[super.getUpdateComplete(),this.stealOverlayContentPromise];t.push(this.contentAnimationPromise),this.overlayContent.updateComplete!==void 0&&t.push(this.overlayContent.updateComplete);const[e]=await Promise.all(t);return e}disconnectedCallback(){document.removeEventListener("sp-update-overlays",this.resetOverlayPosition),super.disconnectedCallback()}};let j=_t;tt([G()],j.prototype,"_state",2),tt([G({reflect:!0,type:Boolean})],j.prototype,"animating",2),tt([G({reflect:!0})],j.prototype,"placement",2),tt([G({attribute:!1})],j.prototype,"theme",2),tt([G({attribute:!1})],j.prototype,"receivesFocus",2);class se{constructor(e={}){this.warmUpDelay=1e3,this.coolDownDelay=1e3,this.isWarm=!1,this.timeout=0,Object.assign(this,e)}async openTimer(e){if(this.cancelCooldownTimer(),!this.component||e!==this.component)return this.component&&(this.close(this.component),this.cancelCooldownTimer()),this.component=e,!this.isWarm&&(this.promise=new Promise(i=>{this.resolve=i,this.timeout=window.setTimeout(()=>{this.resolve&&(this.resolve(!1),this.isWarm=!0)},this.warmUpDelay)}),this.promise);if(this.promise)return this.promise;throw new Error("Inconsistent state")}close(e){this.component&&this.component===e&&(this.resetCooldownTimer(),this.timeout>0&&(clearTimeout(this.timeout),this.timeout=0),this.resolve&&(this.resolve(!0),delete this.resolve),delete this.promise,delete this.component)}resetCooldownTimer(){this.isWarm&&(this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),this.cooldownTimeout=window.setTimeout(()=>{this.isWarm=!1,delete this.cooldownTimeout},this.coolDownDelay))}cancelCooldownTimer(){this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),delete this.cooldownTimeout}}customElements.define("active-overlay",j);function Nt(){return new Promise(t=>requestAnimationFrame(()=>t()))}const ct=class{constructor(t,e,i){this.isOpen=!1,this.owner=t,this.overlayElement=i,this.interaction=e}static async open(t,e,i,n){const s=new ct(t,e,i);return await s.open(n),()=>{s.close()}}static update(){const t=new CustomEvent("sp-update-overlays",{bubbles:!0,composed:!0,cancelable:!0});document.dispatchEvent(t)}async open({abortPromise:t,delayed:e,offset:i=0,placement:n="top",receivesFocus:s,notImmediatelyClosable:o,virtualTrigger:r,root:l}){if(this.isOpen)return!0;e===void 0&&(e=this.overlayElement.hasAttribute("delayed"));const a={color:void 0,scale:void 0,lang:void 0,theme:void 0},c=new CustomEvent("sp-query-theme",{bubbles:!0,composed:!0,detail:a,cancelable:!0});this.owner.dispatchEvent(c);const h={},d=new CustomEvent("sp-overlay-query",{bubbles:!0,composed:!0,detail:h,cancelable:!0});return this.overlayElement.dispatchEvent(d),await ct.overlayStack.openOverlay({abortPromise:t,content:this.overlayElement,contentTip:h.overlayContentTipElement,delayed:e,offset:i,placement:n,trigger:this.owner,interaction:this.interaction,theme:a,receivesFocus:s,root:l,notImmediatelyClosable:o,virtualTrigger:r,...h}),this.isOpen=!0,!0}close(){ct.overlayStack.closeOverlay(this.overlayElement)}};let Bt=ct;Bt.overlayStack=new class{constructor(){this.overlays=[],this.preventMouseRootClose=!1,this.root=document.body,this.handlingResize=!1,this.overlayTimer=new se,this.canTabTrap=!0,this.trappingInited=!1,this._eventsAreBound=!1,this._bodyMarginsApplied=!1,this.forwardContextmenuEvent=async t=>{var e;const i=this.overlays[this.overlays.length-1];!this.trappingInited||i.interaction!=="modal"||t.target!==this.overlayHolder||(t.stopPropagation(),t.preventDefault(),await this.closeTopOverlay(),(e=((n,s)=>{let o=document.elementFromPoint(n,s);for(;o!=null&&o.shadowRoot;){const r=o.shadowRoot.elementFromPoint(n,s);if(!r||r===o)break;o=r}return o})(t.clientX,t.clientY))==null||e.dispatchEvent(new MouseEvent("contextmenu",t)))},this.handleOverlayClose=t=>{const{root:e}=t;e&&this.closeOverlaysForRoot(e)},this.handleMouseCapture=t=>{const e=this.topOverlay;var i;if(t.target&&e&&e.overlayContent&&!((i=t).metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&function(n){return n.button===0}(t)){if(t.target instanceof Node){if(t.composedPath().indexOf(e.overlayContent)>=0)return void(this.preventMouseRootClose=!0);this.preventMouseRootClose=!1}}else this.preventMouseRootClose=!0},this._doesNotCloseOnFirstClick=!1,this.handleMouse=t=>{var e;if(this._doesNotCloseOnFirstClick)return void(this._doesNotCloseOnFirstClick=!1);if(this.preventMouseRootClose||t.defaultPrevented)return;const i=[];let n=this.overlays.length;for(;n&&i.length===0;){n-=1;const r=this.overlays[n],l=t.composedPath();(!l.includes(r.trigger)||r.interaction!=="hover")&&!l.includes(r.overlayContent)&&i.push(r)}let s=(e=this.topOverlay)==null?void 0:e.root,o=V(s);for(;s&&o;)i.push(o),o=V(s),s=o==null?void 0:o.root;o&&i.push(o),i.forEach(r=>this.hideAndCloseOverlay(r))},this.handleKeydown=t=>{t.code==="Escape"&&this.closeTopOverlay()},this.handleResize=()=>{this.handlingResize||(this.handlingResize=!0,requestAnimationFrame(async()=>{const t=this.overlays.map(e=>e.updateOverlayPosition());await Promise.all(t),this.handlingResize=!1}))},this.initTabTrapping()}initTabTrapping(){if(document.readyState==="loading")return void document.addEventListener("readystatechange",()=>{this.initTabTrapping()},{once:!0});if(this.trappingInited)return;if(this.trappingInited=!0,this.document.body.shadowRoot)return void(this.canTabTrap=!1);if(this.document.body.attachShadow({mode:"open"}),!this.document.body.shadowRoot)return;const t=this.document.body.shadowRoot;t.innerHTML=`
            <style>
            :host {
                position: relative;
            }
            #actual {
                position: relative;
                height: calc(100% - var(--swc-body-margins-block, 0px));
                z-index: 0;
                min-height: calc(100vh - var(--swc-body-margins-block, 0px));
            }
            #holder {
                display: none;
                align-items: center;
                justify-content: center;
                flex-flow: column;
                width: 100%;
                height: 100%;
                position: absolute;
                top: 0;
                left: 0;
            }
            [name="open"]::slotted(*) {
                pointer-events: all;
            }
            #actual[aria-hidden] + #holder {
                display: flex;
            }
            </style>
            <div id="actual"><slot></slot></div>
            <div id="holder"><slot name="open"></slot></div>
        `,this.tabTrapper=t.querySelector("#actual"),this.overlayHolder=t.querySelector("#holder"),this.tabTrapper.attachShadow({mode:"open"}),this.tabTrapper.shadowRoot&&(this.tabTrapper.shadowRoot.innerHTML="<slot></slot>"),this.overlayHolder.addEventListener("contextmenu",this.forwardContextmenuEvent,!0),requestAnimationFrame(()=>{this.applyBodyMargins(),new ResizeObserver(()=>{this.applyBodyMargins()}).observe(document.body)})}applyBodyMargins(){const{marginLeft:t,marginRight:e,marginTop:i,marginBottom:n}=getComputedStyle(document.body),s=parseFloat(t)===0&&parseFloat(e)===0&&parseFloat(i)===0&&parseFloat(n)===0;s&&!this._bodyMarginsApplied||(this.tabTrapper.style.setProperty("--swc-body-margins-inline",`calc(${t} + ${e})`),this.tabTrapper.style.setProperty("--swc-body-margins-block",`calc(${i} + ${n})`),this._bodyMarginsApplied=!s)}startTabTrapping(){this.initTabTrapping(),this.canTabTrap&&(this.tabTrapper.tabIndex=-1,this.tabTrapper.setAttribute("aria-hidden","true"))}stopTabTrapping(){!this.canTabTrap||!this.trappingInited||(this.tabTrapper.removeAttribute("tabindex"),this.tabTrapper.removeAttribute("aria-hidden"))}get document(){return this.root.ownerDocument||document}get topOverlay(){return this.overlays.slice(-1)[0]}findOverlayForContent(t){for(const e of this.overlays)if(t===e.overlayContent)return e}addEventListeners(){this._eventsAreBound||(this._eventsAreBound=!0,this.document.addEventListener("click",this.handleMouseCapture,!0),this.document.addEventListener("click",this.handleMouse),this.document.addEventListener("keydown",this.handleKeydown),this.document.addEventListener("sp-overlay-close",this.handleOverlayClose),window.addEventListener("resize",this.handleResize))}isClickOverlayActiveForTrigger(t){return this.overlays.some(e=>t===e.trigger&&e.interaction==="click")}async openOverlay(t){if(this.addEventListeners(),this.findOverlayForContent(t.content))return!1;t.notImmediatelyClosable&&(this._doesNotCloseOnFirstClick=!0),t.interaction==="modal"&&this.startTabTrapping();const e=t.content,{trigger:i}=t;if(e.overlayWillOpenCallback&&e.overlayWillOpenCallback({trigger:i}),t.delayed){const o=[this.overlayTimer.openTimer(t.content)];t.abortPromise&&o.push(t.abortPromise);const r=await Promise.race(o);if(r)return e.overlayOpenCancelledCallback&&e.overlayOpenCancelledCallback({trigger:i}),r}if(t.root&&this.closeOverlaysForRoot(t.root),t.interaction==="click")this.closeAllHoverOverlays();else if(t.interaction==="hover"&&this.isClickOverlayActiveForTrigger(t.trigger))return!0;const n=j.create(t);this.overlays.length&&this.overlays[this.overlays.length-1].obscure(n.interaction),document.body.appendChild(n),await Nt(),this.overlays.push(n),await n.updateComplete,this.addOverlayEventListeners(n),e.open!==void 0&&(await Nt(),e.open=!0);let s=()=>{};if(e.overlayOpenCallback){const{trigger:o}=n,{overlayOpenCallback:r}=e;s=async()=>await r({trigger:o})}return await n.openCallback(s),!1}addOverlayEventListeners(t){switch(t.addEventListener("close",()=>{this.hideAndCloseOverlay(t,!0)}),t.interaction){case"replace":this.addReplaceOverlayEventListeners(t);break;case"inline":this.addInlineOverlayEventListeners(t)}}addReplaceOverlayEventListeners(t){t.addEventListener("keydown",e=>{const{code:i}=e;i==="Tab"&&(e.stopPropagation(),this.closeOverlay(t.overlayContent),t.tabbingAway=!0,t.trigger.focus(),t.trigger.dispatchEvent(new KeyboardEvent("keydown",e)))})}addInlineOverlayEventListeners(t){t.trigger.addEventListener("keydown",t.handleInlineTriggerKeydown),t.addEventListener("keydown",e=>{const{code:i,shiftKey:n}=e;if(i!=="Tab")return;if(t.tabbingAway=!0,n){const o=document.createElement("span");return o.tabIndex=-1,t.trigger.hasAttribute("slot")&&(o.slot=t.trigger.slot),t.trigger.insertAdjacentElement("afterend",o),o.focus(),void o.remove()}e.stopPropagation();const s=t.trigger;s.open!==void 0&&(s.open=!1),this.closeOverlay(t.overlayContent),t.trigger.focus()})}closeOverlay(t){this.overlayTimer.close(t),requestAnimationFrame(()=>{const e=this.findOverlayForContent(t),i=[e];i.push(...ht(e,this.overlays)),i.forEach(n=>this.hideAndCloseOverlay(n))})}closeAllHoverOverlays(){for(const t of this.overlays)t.interaction==="hover"&&this.hideAndCloseOverlay(t,!1)}closeOverlaysForRoot(t){const e=[];for(const i of this.overlays)i.root&&i.root===t&&(e.push(i),e.push(...ht(i,this.overlays)));e.forEach(i=>this.hideAndCloseOverlay(i,!0,!0))}async manageFocusAfterCloseWhenOverlaysRemain(t,e){const i=this.overlays[this.overlays.length-1];if(i.feature(),i.interaction==="modal"||i.hasModalRoot){if(t)return;await(e||i).focus()}else this.stopTabTrapping()}manageFocusAfterCloseWhenLastOverlay(t){this.stopTabTrapping();const e=t.interaction==="modal",i=t.receivesFocus==="auto",n=t.interaction==="replace",s=t.interaction==="inline",o=(n||s)&&!t.tabbingAway;if(t.tabbingAway=!1,!e&&!i&&!o)return;const r=t.overlayContent.getRootNode().activeElement;let l,a;(e||t.overlayContent.contains(r)||(l=t.trigger.getRootNode(),a=l.activeElement,l.contains(a))||l.host&&l.host===a)&&t.trigger.focus()}async hideAndCloseOverlay(t,e,i){if(!t)return;const n=t.overlayContent;if(n.overlayWillCloseCallback!==void 0){const{trigger:o}=t;if(n.overlayWillCloseCallback({trigger:o}))return}if(await t.hide(e),n.open!==void 0&&(n.open=!1),n.overlayCloseCallback){const{trigger:o}=t;await n.overlayCloseCallback({trigger:o})}if(t.state!="dispose")return;const s=this.overlays.indexOf(t);s>=0&&this.overlays.splice(s,1),this.overlays.length?await this.manageFocusAfterCloseWhenOverlaysRemain(i||t.interaction==="hover",t.trigger):this.manageFocusAfterCloseWhenLastOverlay(t),await t.updateComplete,t.remove(),t.dispose(),t.trigger.dispatchEvent(new CustomEvent("sp-closed",{bubbles:!0,composed:!0,cancelable:!0,detail:{interaction:t.interaction}}))}closeTopOverlay(){return this.hideAndCloseOverlay(this.topOverlay,!0)}};export{Bt as Overlay};
//# sourceMappingURL=overlay.js.map
